#!/bin/sh

echo "donne moi les pleins pouvoirs, gros"
sudo -v

if ! type "brew" > /dev/null; then
  ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

if ! type "/usr/local/bin/zsh" > /dev/null; then
  brew install zsh
  echo "/usr/local/bin/zsh" | sudo tee -a /etc/shells
  chsh -s /usr/local/bin/zsh
  echo "restart l'application de terminal pour finir l'install de zsh"
fi

zsh ./zshinstall

source ./brewfile
source ./osx

if [ ! -f "$HOME/.gitconfig" ]; then
  ln -s ~/dotfiles/gitconfig ~/.gitconfig
fi

# Si .vimrc n'exsite pas, vim fait n'importe quoi sous osx
if [ ! -f ~/.vimrc ]; then
  ln -s ~/dotfiles/vim/vimrc ~/.vimrc
  mkdir ~/.vim
  cd ~/.vim
  ln -s ~/dotfiles/vim/colors/ colors
  mkdir ~/.vim/bundle
  git clone https://github.com/gmarik/Vundle.vim.git ~/.vim/bundle/Vundle.vim
  cd ~/dotfiles
fi

if [ ! -f "$HOME/Library/Preferences/com.divisiblebyzero.Spectacle.plist" ]; then
  ln -s ~/dotfiles/spectacle/com.divisiblebyzero.Spectacle.plist ~/Library/Preferences/com.divisiblebyzero.Spectacle.plist
else
  rm ~/Library/Preferences/com.divisiblebyzero.Spectacle.plist
  ln -s ~/dotfiles/spectacle/com.divisiblebyzero.Spectacle.plist ~/Library/Preferences/com.divisiblebyzero.Spectacle.plist
fi
